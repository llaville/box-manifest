<!-- markdownlint-disable MD013 MD024 MD036 -->
# Changes in 4.x

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html),
and is generated by [Changie](https://github.com/miniscruff/changie).

## 4.0.1 - 2024-11-04

### Changed

Drop PHPUnit 10 support and upgrade to PHPUnit 11

- [#14](https://github.com/llaville/box-manifest/issues/14) : PHPUnit 11 support

### Fixed

- PHPStan may now analyse source code on level 9, that became compatible
- Give a chance to `RestartHandler` to restart process with `phar.readonly` disabled even if `xdebug` extension is not available

**Full Changelog**: [4.0.0...4.0.1](https://github.com/llaville/box-manifest/compare/4.0.0...4.0.1)

## 4.0.0 - 2024-10-03

Read the [first release candidate](https://github.com/llaville/box-manifest/releases/tag/4.0.0-rc.1) notes of this major version
to learn more about changes since 3.5.1

### Fixed

- [GH-13](https://github.com/llaville/box-manifest/issues/13) : v4.0.0-rc.1 does not support correctly the BOX `dump-autoload` setting

**Full Changelog**: [4.0.0-rc.1...4.0.0](https://github.com/llaville/box-manifest/compare/4.0.0-rc.1...4.0.0)

## 4.0.0-rc.1 - 2024-09-04

**Road to stable version 4.0**

After almost one year since the latest 3.5.1 release, weâ€™re getting closer to BOX Manifest 4.0 !

This new major version is based on Pipeline Pattern implemented with excellent package <https://github.com/thephpleague/pipeline>

Read this good article <https://medium.com/@bonnotguillaume/software-architecture-the-pipeline-design-pattern-from-zero-to-hero-b5c43d8a4e60>,
if you are unconfortable with this design pattern.

An effort was made to write a better and enhanced documentation. Read it carefully at <https://llaville.github.io/box-manifest/4.0/>

All features are already included into this first release candidate.
So, if you want to improve this package before final stable version 4.0, please carefully test this version and report any issues found in the [bug reporting system](https://github.com/llaville/box-manifest/issues).

### Added

- Shortcut `-b` for `--bootstrap` option
- Shortcut `-r` for `--resource` option
- New `make` command (to replace legacy commands)
- New `inspect` command to show PHAR manifest list and details
- Install `bamarni/composer-bin-plugin` to handle dev tools without conflicts
- Introduces new ManifestFactory methods: `toSbomJson` and `toSbomXml`

### Changed

- Removed usage of deprecated `Fidry/Console` elements
- Rename `--format` option to `--output-format`, and change origin of constants and visibility
- Upgrade `cyclonedx/cyclonedx-library` constraint to use major version 3
- Use latest SBOM specification version (1.6) as default
- Consider serialNumber as optional and do not stop SBOM generation if an appropriate source of randomness cannot be found
- Default build strategy has evolved to produce a new decorated console table format
- Version of BOX Manifest used to generate stub (from template) is now identified
- Introduces auto-detection by new filenames (see `Bartlett\BoxManifest\Composer\DefaultStrategy::getCallable` for details)

### Fixed

- [#11](https://github.com/llaville/box-manifest/issues/11) : No longer require `phar.readonly` to be off for using PHPUnit

**Full Changelog**: [3.5.1...4.0.0-rc.1](https://github.com/llaville/box-manifest/compare/3.5.1...4.0.0-rc.1)

## 3.5.1 - 2023-10-13

IMPORTANT: This bugfix release mark the latest version that will support BOX v4 and development is stopped !

### Changed

- update `humbug/box` constraint to restrict BOX v4 support to 4.3.x
- use latest SBOM spec version (1.5) on `manifest:build` command

### Fixed

- #10: `box:validate` command support now the recommendation color style formatter

**Full Changelog**: [3.5.0...3.5.1](https://github.com/llaville/box-manifest/compare/3.5.0...3.5.1)

## 3.5.0 - 2023-04-16

**CAUTION** : if you want to use the new `PostInstallStrategy`, please read <https://github.com/composer/composer/discussions/11430> first.

### Added

- `PostInstallStrategy` to keep your manifests synchronized with dependencies installed.

### Changed

- Refactor code to add strategy pattern on manifest build process

**Full Changelog**: [3.4.0...3.5.0](https://github.com/llaville/box-manifest/compare/3.4.0...3.5.0)

## 3.4.0 - 2023-04-10

### Added

- `box:info` command display information about stub used

**Full Changelog**: [3.3.2...3.4.0](https://github.com/llaville/box-manifest/compare/3.3.2...3.4.0)

## 3.3.2 - 2023-04-04

### Fixed

- Cannot run application when command is launched from `vendor/bin/box-manifest` (composer `bin-dir` config)

**WARNING** Unless Composer added support to Symfony/Runtime, do not use `vendor/bin/box-manifest`
that will lead to a fatal error : see <https://github.com/composer/composer/issues/11416> for details

**Full Changelog**: [3.3.1...3.3.2](https://github.com/llaville/box-manifest/compare/3.3.1...3.3.2)

## 3.3.1 - 2023-04-01

Same contents of release 3.3.0

### Fixed

- PHAR distribution was not built during Release GitHub Workflow.

**Full Changelog**: [3.3.0...3.3.1](https://github.com/llaville/box-manifest/compare/3.3.0...3.3.1)

## 3.3.0 - 2023-04-01

### Added

- `box:compile` and `box:info` are now able to add and display manifest files
- API: introduces `ManifestFormat` enumeration to replace hard-coded values

### Changed

- Ascii Logo and text look like BOX logo
- Displays long version without logo
- SBOM manifests format identify now the BOX Manifest application as tool
- The `manifest:stub` command is now able to use resources list defined by the BOX map settings
- API: `Manifest` enum renamed to `ManifestFile`
- BC breaks: `ManifestFactory` did not used anymore the Box instance (affect class constructor and static create method)

**Full Changelog**: [3.2.1...3.3.0](https://github.com/llaville/box-manifest/compare/3.2.1...3.3.0)

## 3.2.1 - 2023-03-28

### Fixed

- `resources` directory was missing on Docker and PHAR distributions.

**Full Changelog**: [3.2.0...3.2.1](https://github.com/llaville/box-manifest/compare/3.2.0...3.2.1)

## 3.2.0 - 2023-03-28

### Added

- Add new console format to print manifest in a Symfony Console Table format
- Random Serial Number on BOM format (raise Composer constraint to support library version 2.1+)
- created DateTime metadata on BOM format

### Changed

- Application was recombined to form a native 3 Symfony Commands (two native from BOX Manifest itself and three others from BOX Application)
- ManifestFactory may be able to enable or disable the ANSI color code decoration
- ManifestFactory build console output results on auto format detection (by default)

### Fixed

- Respect now the switches off debug mode (`--no-debug`)

**Full Changelog**: [3.1.1...3.2.0](https://github.com/llaville/box-manifest/compare/3.1.1...3.2.0)

## 3.1.1 - 2023-03-23

### Changed

- Replace simple key-value pairs TEXT manifest by highlighted version in PHAR `box-*` commands

### Fixed

- [#6](https://github.com/llaville/box-manifest/issues/6) : Symfony BOX styles are not applied on `box-compile` command
- [#7](https://github.com/llaville/box-manifest/issues/7) : Display manifest at runtime do not respect `--no-ansi` console option rule

**Full Changelog**: [3.1.0...3.1.1](https://github.com/llaville/box-manifest/compare/3.1.0...3.1.1)

## 3.1.0 - 2023-03-22

### Changed

- box-stub command: stub code is no more hard coded and may be changed at runtime with `--template` option
- box-stub command: manifest files is no more hard coded and may be changed at runtime with `--resource` option
- Optimize size of PHAR distributions for box-* commands

### Fixed

- Release workflow was fixed to avoid wrong resource files list to use

**Full Changelog**: [3.0.0...3.1.0](https://github.com/llaville/box-manifest/compare/3.0.0...3.1.0)

## 3.0.0 - 2023-03-21

**BC breaks with this major version**

- Do not use anymore the `cweagans/composer-patches` composer-plugin to patch `humbug/box` at install time.
- This is a real standalone application with three distinct binary commands: `box-manifest`, `box-stub` and `box-compile`

Don't forget to read the documentation and its tutorial that will guide you to create your first manifest with its stub and compile in a PHAR.

### Added

- new Docker workflow to publish docker images to GitHub repository

### Changed

- Entrypoint in Dockerfile refer now to multiple commands
- org.opencontainers.image.version label is generated by docker workflow now (avoid hard-coding and outdated version number)

**Full Changelog**: [2.3.1...3.0.0](https://github.com/llaville/box-manifest/compare/2.3.1...3.0.0)

## 2.3.1 - 2023-03-08

### Changed

- update humbug/box composer constraint to avoid installation of Box 4.3.x not yet supported

**Full Changelog**: [2.3.0...2.3.1](https://github.com/llaville/box-manifest/compare/2.3.0...2.3.1)

## 2.3.0 - 2023-02-17

### Added

- PHPUnit 10 support : phpunit.xml.dist configuration migration

### Fixed

- [#4](https://github.com/llaville/box-manifest/issues/4) : Prevent error when Composer installation does not exists
- [#5](https://github.com/llaville/box-manifest/issues/5) : Prevent Fatal error when root package installed as none version published

**Full Changelog**: [2.2.1...2.3.0](https://github.com/llaville/box-manifest/compare/2.2.1...2.3.0)

## 2.2.1 - 2023-01-14

### Fixed

- regression with previous version 2.2.0 when dependency version have an alias

**Full Changelog**: [2.2.0...2.2.1](https://github.com/llaville/box-manifest/compare/2.2.0...2.2.1)

## 2.2.0 - 2023-01-14

### Changed

- When package version is a branch alias, print branch name with commit reference for SimpleText in same way as DecorateText manifest builder

### Fixed

- update in the Getting Started guide the docker run syntax

**Full Changelog**: [2.1.0...2.2.0](https://github.com/llaville/box-manifest/compare/2.1.0...2.2.0)

## 2.1.0 - 2022-11-28

### Added

- [#3](https://github.com/llaville/box-manifest/issues/3) : New Composer manifest builder to highlight dependencies constraints and versions

**Full Changelog**: [2.0.0...2.1.0](https://github.com/llaville/box-manifest/compare/2.0.0...2.1.0)

## 2.0.0 - 2022-11-24

### Added

- [#2](https://github.com/llaville/box-manifest/issues/2) : Add support to BOX v4

**Full Changelog**: [1.2.0...2.0.0](https://github.com/llaville/box-manifest/compare/1.2.0...2.0.0)
