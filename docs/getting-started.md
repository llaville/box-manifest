<!-- markdownlint-disable MD013 MD028 -->
# Getting Started

## Requirements

* PHP 8.2 or greater
* ext-phar
* PHPUnit 10 or greater (if you want to run unit tests)

## Docker

> v4.x docker images provided run in rootless mode, so you don't have to specify `-u $(id -u ${USER}):$(id -g ${USER})` options.

> Please mount the code directory to `/app` in the container.

Usage examples :

```shell
docker run --rm -it -v $(pwd):/app -w /app ghcr.io/llaville/box-manifest:v4 manifest:build -c box.json --output-file=sbom.xml
docker run --rm -it -v $(pwd):/app -w /app ghcr.io/llaville/box-manifest:v4 manifest:build -c box.json --output-file=manifest.txt
docker run --rm -it -v $(pwd):/app -w /app ghcr.io/llaville/box-manifest:v4 manifest:build -c box.json --output-file=console.txt
docker run --rm -it -v $(pwd):/app -w /app ghcr.io/llaville/box-manifest:v4 manifest:stub -c box.json --output-file=stub.php

docker run --rm -it -v $(pwd):/app -w /app ghcr.io/llaville/box-manifest:v4 manifest:build --bootstrap tests/fixtures/my-manifest.php --format \\Bartlett\\BoxManifest\\Tests\\fixtures\\ConsoleManifest -v
```

## Usage

```text

    ____                __  ___            _ ____          __
   / __ )____  _  __   /  |/  /___ _____  (_) __/__  _____/ /_
  / __  / __ \| |/_/  / /|_/ / __ `/ __ \/ / /_/ _ \/ ___/ __/
 / /_/ / /_/ />  <   / /  / / /_/ / / / / / __/  __(__  ) /_
/_____/\____/_/|_|  /_/  /_/\__,_/_/ /_/_/_/  \___/____/\__/

BOX Manifest 4.x-dev@8f2bd10

Usage:
  command [options] [arguments]

Options:
  -h, --help            Display help for the given command. When no command is given display help for the list command
  -q, --quiet           Do not output any message
  -V, --version         Display this application version
      --ansi|--no-ansi  Force (or disable --no-ansi) ANSI output
  -n, --no-interaction  Do not ask any interactive question
  -v|vv|vvv, --verbose  Increase the verbosity of messages: 1 for normal output, 2 for more verbose output and 3 for debug

Available commands:
  completion      Dump the shell completion script
  help            Display help for a command
  list            List commands
 manifest
  manifest:build  Creates a manifest of your software components and dependencies.
  manifest:stub   Generates a stub for your manifest application.
```

This Symfony Console application combines two native commands, and three others inherited from BOX Application.

### Symfony `manifest:build` command

To build your application's manifest file(s).

```text
Description:
  Creates a manifest of your software components and dependencies.

Usage:
  manifest:build [options]

Options:
      --no-config                Ignore the config file even when one is specified with the --config option
  -c, --config=CONFIG            The alternative configuration file path.
      --bootstrap=BOOTSTRAP      A PHP script that is included before execution
  -f, --format=FORMAT            Format of the output: auto, plain, ansi, console, sbom-xml, sbom-json [default: "auto"]
  -s, --sbom-spec=SBOM-SPEC      SBOM specification version: 1.1, 1.2, 1.3, 1.4, 1.5 [default: "1.5"]
  -o, --output-file=OUTPUT-FILE  Write results to file (default to standard output)
  -h, --help                     Display help for the given command. When no command is given display help for the list command
  -q, --quiet                    Do not output any message
  -V, --version                  Display this application version
      --ansi|--no-ansi           Force (or disable --no-ansi) ANSI output
  -n, --no-interaction           Do not ask any interactive question
  -v|vv|vvv, --verbose           Increase the verbosity of messages: 1 for normal output, 2 for more verbose output and 3 for debug

Help:
  The manifest:build command will generate a manifest of your application.
```

The `--output-file` and `--format` options can be used to control the formatting and destination
of the output generated by `box-manifest`.
The default is to report to the console standard output but can be stored in a file (specified using `--output-file` option).
The format of the output can be changed using the `--format` option which may be useful if the output is to be used
as an input by another tool like `box`.

The `--config` option can be used to specify path to alternate version of a `box.json.dist` or `box.json`
that are not found in current working directory.

The `--no-config` option must be specified if you don't want to use BOX default configuration files (`box.json.dist` or `box.json`)

Once generated with the `--output-file` option, the manifest may be included as any other files you want to add into your PHP Archive.

### Symfony `manifest:stub` command

To build the stub that will support `--manifest` option, to display its contents at runtime.

```text
Description:
  Generates a stub for your manifest application.

Usage:
  manifest:stub [options]

Options:
      --no-config                Ignore the config file even when one is specified with the --config option
  -c, --config=CONFIG            The alternative configuration file path.
  -t, --template=TEMPLATE        PHP template file to customize the stub
      --resource=RESOURCE        File(s) generated by the box-manifest binary command (multiple values allowed)
  -o, --output-file=OUTPUT-FILE  Write results to file (default to standard output)
  -h, --help                     Display help for the given command. When no command is given display help for the list command
  -q, --quiet                    Do not output any message
  -V, --version                  Display this application version
      --ansi|--no-ansi           Force (or disable --no-ansi) ANSI output
  -n, --no-interaction           Do not ask any interactive question
  -v|vv|vvv, --verbose           Increase the verbosity of messages: 1 for normal output, 2 for more verbose output and 3 for debug

Help:
  The manifest:stub command will generate a stub of your manifest application.
```

The `--output-file` option can be used to control the destination of the output generated by `box-stub`.
The default is to report to the console standard output but can be stored in a file

The `--config` option can be used to specify path to alternate version of a `box.json.dist` or `box.json`
that are not found in current working directory.

The `--no-config` option must be specified if you don't want to use BOX default configuration files (`box.json.dist` or `box.json`)

### Define the manifest in the `metadata` field of your PHP Archive

Like in previous versions  (1.x and 2.x), if you want to keep the manifest included in the metadata field of your PHAR,
then you must configure [`metadata`][metadata-directive] directive with a [PHP callable][php-callables].

E.g: See also the [tutorial](./Tutorial/README.md) to learn more.

```json
{
  "metadata": "MyCallbacks::manifest"
}
```

**NOTE** if none of manifest files (default: `manifest.txt`, `manifest.xml`, `sbom.xml`, `sbom.json`) are found, when you execute `box:compile` command,
then metadata field of your PHAR will contain NULL value (default BOX behavior).

[metadata-directive]: https://github.com/box-project/box/blob/main/doc/configuration.md#metadata-metadata
[php-callables]: https://www.php.net/manual/en/language.types.callable.php
