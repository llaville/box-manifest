<!-- markdownlint-disable MD013 MD029 MD033 -->
# Last but not the least, include a custom stub to display manifests

Of course running CLI commands to verify contents is not so hard, but we may expect a better user experience.
Adding a `--manifest` option that will either :

- search for the first manifest available in a priority files list
- show a specific version

Create, for example this custom stub, either manually or with the `box-manifest stub` command.

```php
<?php
Phar::mapPhar('app-fixtures-alias.phar');

// default stub template @generated by BOX Manifest

$withManifest = array_search('--manifest', $argv);
$withoutAnsi = array_search('--no-ansi', $argv);

if ($withManifest !== false) {
    $manifestDir = '.box.manifests/';
    $resources = (($argc - 1 > $withManifest) && !str_starts_with($argv[$withManifest + 1], '-')) ? [$argv[$withManifest + 1]] : ['manifest.txt', 'manifest.xml', 'sbom.xml', 'sbom.json', 'console.txt'];

    foreach ($resources as $resource) {
        $res = str_replace($manifestDir, '', $resource);
        $filename = "phar://app-fixtures-alias.phar/{$manifestDir}{$res}";
        if (file_exists($filename)) {
            $manifest = file_get_contents($filename);
            if ($withoutAnsi !== false) {
                $manifest = preg_replace('#\\x1b[[][^A-Za-z]*[A-Za-z]#', '', $manifest);
            }
            echo $manifest, PHP_EOL;
            exit(0);
        } elseif (count($resources) === 1) {
            echo sprintf('Manifest "%s" is not available in this PHP Archive.', $resource), PHP_EOL;
            exit(2);
        }
    }
    echo 'No manifest found in this PHP Archive', PHP_EOL;
    exit(1);
}


require 'phar://app-fixtures-alias.phar/.box/bin/check-requirements.php';

__HALT_COMPILER(); ?>
```

And declare it, in the BOX config file `app-fixtures.box.json.dist`, with excerpt :

```json
{
  "stub": "app-fixtures-stub.php"
}
```

Then re-compile for the last time your PHP Archive.

You are now able to display either the first manifest available (`manifest.txt` is included and is on top or priority list)

```shell
./app-fixtures.phar --manifest
```

That prints following results :

```text
root/app-fixtures: 3.x-dev@9661882
psr/log: 3.0.0
```

Or a specific version, like :

```shell
./app-fixtures.phar --manifest sbom.xml
```

That prints following results :

```xml
<?xml version="1.0" encoding="UTF-8"?>
<bom xmlns="http://cyclonedx.org/schema/bom/1.5" version="1" serialNumber="urn:uuid:0337c091-d806-401f-8ff3-68a668894618">
    <metadata>
        <timestamp><![CDATA[2023-10-13T08:56:20Z]]></timestamp>
        <tools>
            <tool>
                <vendor><![CDATA[box-project]]></vendor>
                <name><![CDATA[box]]></name>
                <version><![CDATA[4.3.8@5534406]]></version>
            </tool>
            <tool>
                <vendor><![CDATA[bartlett]]></vendor>
                <name><![CDATA[box-manifest]]></name>
                <version><![CDATA[3.5.1]]></version>
            </tool>
        </tools>
        <properties>
            <property name="specVersion"><![CDATA[1.5]]></property>
            <property name="bomFormat"><![CDATA[CycloneDX]]></property>
        </properties>
    </metadata>
    <components>
        <component type="library" bom-ref="pkg:composer/psr/log@3.0.0">
            <group><![CDATA[psr]]></group>
            <name><![CDATA[log]]></name>
            <version><![CDATA[3.0.0]]></version>
            <purl><![CDATA[pkg:composer/psr/log@3.0.0]]></purl>
        </component>
    </components>
    <dependencies>
        <dependency ref="pkg:composer/psr/log@3.0.0"/>
    </dependencies>
</bom>
```

And if you ask for an unavailable version into the PHP Archive,

```shell
./app-fixtures.phar --manifest sbom.json
```

You'll get

```text
Manifest "sbom.json" is not available in this PHP Archive.
```
